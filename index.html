<html>
	<head>
		<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1.0, user-scalable=no">
		<link rel="stylesheet" type="text/css" href="style/chat.css"/>
		<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.0.0-alpha1/jquery.min.js"></script>
		<script src="https://cdnjs.cloudflare.com/ajax/libs/pubnub/3.7.7/pubnub.min.js"></script>
		<script src="//www.parsecdn.com/js/parse-1.6.12.min.js"></script>
		<script src="https://cdnjs.cloudflare.com/ajax/libs/underscore.js/1.8.3/underscore-min.js"></script>
		<script src="https://cdnjs.cloudflare.com/ajax/libs/moment.js/2.10.6/moment.min.js"></script>
		<script src="https://cdnjs.cloudflare.com/ajax/libs/livestamp/1.1.2/livestamp.min.js"></script>
		<script src="https://cdnjs.cloudflare.com/ajax/libs/fastclick/1.0.6/fastclick.min.js"></script>
		<script>
		//get rid of the 300ms delay with fastclick.js
		if ('addEventListener' in document) {
		    document.addEventListener('DOMContentLoaded', function() {
		        FastClick.attach(document.body);
		    }, false);
		}
		</script>
		<script src="scripts/chat.js"></script>
	</head>
	<body id="chatapp">
		<div class="spinner">...wait</div>
		<div id="chat_container"></div>
	</body>

	<script type="text/html" id="loginscreen">
		<form id="loginform">
		<div class="row">
			<label for="username">Username: <input required type="text" id="username" name="username"/></label>
		</div>
		<div class="row">
			<label for="password">Password: <input required type="password" id="password" name="password"/></label>
		</div>
		<div class="row spacetop">
			<input type="submit" value="Sign in"/>
		</div>
			<div class="row spacetop">
			<a href="#" id="register">Register</a>
			</div>
			<div class="row">
			 <a href="#" id="forgotpasswordlink">Forgot password</a>
			 </div>
			 <div class="row spacetop">
			  <a class="button quiet" href="#" id="signinasguest" data-guestname="">Enter as <strong>guestname</strong></a>
			  	<label><small><strong>Note:</stong> Guest users cannot...</small></label>
			  </div>

		</form>
	</script>
	
	<script type="text/html" id="registerscreen">
		<form id="registerform">
		<div class="row">
			<label for="register_username">Desired username: <small>This is how others will know you </small><input required type="text" id="register_username" name="username"/></label>
			</div>
			<div class="row">
			<label for="register_email">Email:<small>It has to be a valid email address</small> <input required type="email" id="register_email" name="email"/>
			</div>
			<div class="row">
			<label for="register_password">Password:<small>Choose a secure password</small> <input required type="password" id="register_password" name="password"/></label>
			</div>
			<div class="row spacetop">
			<input type="submit" value="Register"/>
			</div>
			<div class="row spacetop">
			<a href="#" id="backtologin">Back to login?</a>
			</div>
		</form>
	</script>
	
	<script type="text/html" id="chatwindow">
		<div class="chatwindow">
			<div class="header">
				<a class="tab selected" data-tab="mainchat" href="#">
					<img src="images/chat.svg" class="icon"/>
				</a>
				<a class="tab" data-tab="userslist" href="#">
				<img src="images/users.svg" class="icon"/>
				<span class="occupancy" id="main_occupancy"> <%=occupancy%></span></a>
				<a class="tab" data-tab="conversations" href="#">
					<img src="images/conversations.svg" class="icon"/>
					<span class="counter" data-count="0">0</span></a>
				<a class="tab" data-tab="settings" href="#">
					<img class="icon avatar" src="<%=userimage%>"/>
				<!--<%=username%>-->
				</a>
			</div>
			<div class="content">
				<div class="appview" style="display:block" data-tab="mainchat">
					<div class="wrapper">
						<div class="scroller" id="mainchatscroller" data-channel="<%=mainchannelname%>" data-room="<%=mainchannelname%>"></div>
						<div class="footer">
							<a class="sayitbutton button" href="#">Say it</a>
							<input data-channel="<%=mainchannelname%>" type="text" id="postonmainchat" placeholder="say something"/>
						</div>
					</div>
				</div>
				<div class="appview" data-tab="userslist">
					<div class="scroller">
						<% _.each(users, function(user) { %> 
							<%if(user.state.username){

								%>

								<a class="user" data-user="<%= user.state.username %>">
						    <img class="avatar" src="<%=user.state.userimage%>"/>
						    <%= user.state.username %>
						    
						    	
						    	

						    </a>

								<%

							}%>
						    
						<% }); %>
					</div>
				</div>
				<div class="appview" data-tab="conversations">
					<div class="wrapper">
						<div class="scroller conversations_container">
						<div class="empty">you have no private conversations</div>





						</div>
						
					</div>
				</div>
				<div class="appview" data-tab="settings">
					<div class="scroller">settings</div>
				</div>

			</div>
			
		</div>
	</script>
	<script type="text/html" id="user_item_template">
		
		<a class="user" data-user="<%=user%>">
			<img class="avatar"/>
			<%=user%>
		</a>	
		
	</script>
	<script type="text/html" id="chatline">
		<div data-chat-id="<%=user%><%=time%>" class="chatline animated fadeIn" data-author="<%=user%>">
			<img src="<%=avatar%>" class="avatar"/>
			<span class="user"><%=user%></span>
			<span class="message"><%=message%></span>
			<span class="time" data-livestamp="<%=time%>">&nbsp;</span>
		</div>
	</script>
	<script type="text/html" id="conversation_user">
		<a class="conversation" data-room="<%=room%>" data-partner="<%=partner%>" data-channel="<%=channel%>" data-lastmsg="<%=lastmessagetime%>">
								<div class="avatar">
									<img src="<%=avatar%>"/>
								</div>
								<div class="user"><%=user%></div>
								<div class="lastmsg">
									<div class="from"><%=lastmessagefrom%>:</div>
									<div class="message"><%=lastmessage%></div>
									<div class="time" data-livestamp="<%=lastmessagetime%>">&nbsp;</div>
								</div>
							</a>
	</script>
	<script type="text/html" id="private_conversation">
		<div id="privatewindow" class="private_window" data-partner="<%=partner%>" data-room="<%=room%>">
			<div class="top_bar">
			<a href="#" id="closeprivatewindow" class="back">
			<img src="images/back.svg"/>
			<span class="counter animated zoomIn" data-count="0">0</span></a>
				<div class="avatar">
					<img src="<%=partner_avatar_url%>"/>
				</div>
				
			<span class="title">
				<%=partner%> 
			</span>
			</div>

			<div class="chatlines">
				<div class="wrapper">
					<div class="empty">Start a private conversation with <%=partner%></div>
				</div>
				
			</div>
			<div class="footer">
				<a class="sayitbutton button" href="#">Say it</a>
				<input data-channel="<%=channel%>" placeholder="say something">
			</div>
		</div>
	</script>
</html>