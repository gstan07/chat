<html>
	<head>
		<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1.0, user-scalable=no">
		<link rel="stylesheet" type="text/css" href="style/chat.css"/>
		<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.0.0-alpha1/jquery.min.js"></script>
		<script src="https://cdnjs.cloudflare.com/ajax/libs/pubnub/3.7.7/pubnub.min.js"></script>
		<script src="//www.parsecdn.com/js/parse-1.6.12.min.js"></script>
		<script src="https://cdnjs.cloudflare.com/ajax/libs/underscore.js/1.8.3/underscore-min.js"></script>
		<script src="https://cdnjs.cloudflare.com/ajax/libs/moment.js/2.10.6/moment.min.js"></script>
		<script src="https://cdnjs.cloudflare.com/ajax/libs/livestamp/1.1.2/livestamp.min.js"></script>
		<script src="https://cdnjs.cloudflare.com/ajax/libs/fastclick/1.0.6/fastclick.min.js"></script>
		<script>
		//get rid of the 300ms delay with fastclick.js
		if ('addEventListener' in document) {
		    document.addEventListener('DOMContentLoaded', function() {
		        FastClick.attach(document.body);
		    }, false);
		}
		</script>
		<script src="scripts/chat.js"></script>
	</head>
	<body id="chatapp">
		<div class="spinner">...wait</div>
		<div id="chat_container"></div>
	</body>

	<script type="text/html" id="loginscreen">
		<form id="loginform">
			<label for="username">Username: <input required type="text" id="username" name="username"/></label>
			<label for="password">Password: <input required type="password" id="password" name="password"/></label>
			<input type="submit" value="Sign in"/>
			<a href="#" id="register">Register</a> <a href="#" id="forgotpasswordlink">Forgot password</a> <a href="#" id="signinasguest" data-guestname="">Sign in as <strong>guestname</strong></a>

		</form>
	</script>
	
	<script type="text/html" id="registerscreen">
		<form id="registerform">
			<label for="register_username">Username: <input required type="text" id="register_username" name="username"/></label>
			<label for="register_email">Email: <input required type="email" id="register_email" name="email"/>
			<label for="register_password">Password: <input required type="password" id="register_password" name="password"/></label>
			<input type="submit" value="Register"/>
			<a href="#" id="backtologin">Back to login?</a>
		</form>
	</script>
	
	<script type="text/html" id="chatwindow">
		<div class="chatwindow">
			<div class="header">
				<a class="tab selected" data-tab="mainchat" href="#">main</a>
				<a class="tab" data-tab="userslist" href="#">Users:<span class="occupancy" id="main_occupancy"> <%=occupancy%></span></a>
				<a class="tab" data-tab="conversations" href="#">Conversations<span class="counter" data-count="0">0</span></a>
				<a class="tab" data-tab="settings" href="#"><%=username%></a>
			</div>
			<div class="content">
				<div class="appview" style="display:block" data-tab="mainchat">
					<div class="wrapper">
						<div class="scroller" data-channel="<%=mainchannelname%>" data-room="<%=mainchannelname%>"></div>
						<div class="footer">
							<a class="sayitbutton button" href="#">Say it</a>
							<input data-channel="<%=mainchannelname%>" type="text" id="postonmainchat" placeholder="say something"/>
						</div>
					</div>
				</div>
				<div class="appview" data-tab="userslist">
					<div class="scroller">
						<% _.each(users, function(user) { %> 
						    <div class="user" data-user="<%= user %>"><%= user %></div>
						<% }); %>
					</div>
				</div>
				<div class="appview" data-tab="conversations">
					<div class="wrapper">
						<div class="scroller conversations_container">
						<div class="empty">you have no private conversations</div>
						</div>
					</div>
				</div>
				<div class="appview" data-tab="settings">
					<div class="scroller">settings</div>
				</div>

			</div>
			
		</div>
	</script>
	<script type="text/html" id="user_item_template">
		
		<div class="user" data-user="<%=user%>"><%=user%></div>	
		
	</script>
	<script type="text/html" id="chatline">
		<div data-chat-id="<%=user%><%=time%>" class="chatline" data-author="<%=user%>">
			<span class="user"><%=user%></span>
			<span class="message"><%=message%></span>
			<span class="time" data-livestamp="<%=time%>">&nbsp;</span>
		</div>
	</script>
	<script type="text/html" id="conversation_user">
		conversation_user
	</script>
	<script type="text/html" id="private_conversation">
		<div class="private_window" data-partner="<%=partner%>" data-room="<%=room%>">
			<div class="top_bar">
			<a href="#" class="back">back</a>
				<div class="avatar">
					<img src="https://cdn4.iconfinder.com/data/icons/unigrid-human/52/011_user_profile_avatar_woman_girl_round-64.png"/>
				</div>
				
			<span class="title">
				<%=partner%> 
			</span>
			<span class="lastmsg">
					<span class="user"></span>
					<span class="message"></span>
					<span class="time"></span>
				</span>
			<!--<a href="#" class="profile">profile</a>-->
				<!--<a href="#" class="toggler on">open</a>-->
				&nbsp; 
				
				</div>

			<div class="scroller">
				private coversation with <%=partner%>
			</div>
			<div class="footer">
				<a class="sayitbutton button" href="#">Say it</a>
				<input data-channel="<%=channel%>" placeholder="say something">
			</div>
		</div>
	</script>
</html>